openapi: 3.0.0
info:
  title: Store Management API
  version: 0.1.0
  description: API для управления магазином (продукты) с поддержкой JWT и фильтрации
servers:
  - url: http://localhost:8080
    description: Локальный сервер
tags:
  - name: Auth
    description: Аутентификация и авторизация
  - name: Products
    description: Операции с продуктами
  - name: Units
    description: Операции с единицами измерения продуктов
paths:
  # Авторизация и аутентификация
  /api/auth/login:
    post:
      tags: [Auth]
      summary: Получение JWT-токена
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AuthRequest"
      responses:
        200:
          description: Успешная аутентификация
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
        401:
          description: Неверные учетные данные
  # Продукты
  /api/products/all:
    get:
      tags: [Products]
      summary: Получение списка продуктов с фильтрацией и сортировкой
      security:
        - BearerAuth: []
      parameters:
        - name: name
          in: query
          description: Фильтр по названию продукта
          schema:
            type: string
        - name: quantity_min
          in: query
          description: Минимальное количество
          schema:
            type: integer
        - name: unit_id
          in: query
          description: Фильтр по ID единицы измерения
          schema:
            type: integer
        - name: sort_by
          in: query
          description: Поле для сортировки (name, quantity)
          schema:
            type: string
        - name: sort_order
          in: query
          description: Порядок сортировки (asc/desc)
          schema:
            type: string
      responses:
        200:
          description: Список продуктов
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Product"
        401:
          description: Не авторизован
        500:
          description: Внутренняя ошибка сервера
  /api/products/add:
    post:
      tags: [Products]
      summary: Добавление нового продукта
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ProductWithoutId"
      responses:
        201:
          description: Продукт успешно добавлен
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Product"
        400:
          description: Некорректные данные
        500:
          description: Внутренняя ошибка сервера
  /api/products/get/{id}:
    get:
      tags: [Products]
      summary: Получение информации о продукте
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        200:
          description: Информация о продукте
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Product"
        400:
          description: Некорректный ID продукта
        404:
          description: Продукт не найден
        500:
          description: Внутренняя ошибка сервера
  /api/products/update/{id}:
    put:
      tags: [Products]
      summary: Обновление информации о продукте
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ProductWithoutId"
      responses:
        200:
          description: Продукт успешно обновлен
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Product"
        400:
          description: Некорректные данные
        404:
          description: Продукт не найден
        500:
          description: Внутренняя ошибка сервера
  /api/products/delete/{id}:
    delete:
      tags: [Products]
      summary: Удаление продукта
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        200:
          description: Продукт успешно удален
        400:
          description: Некорректный ID продукта
        404:
          description: Продукт не найден
        500:
          description: Внутренняя ошибка сервера
  /api/units/all:
    get:
      tags: [Units]
      summary: Получение списка всех единиц измерения
      responses:
        200:
          description: Список единиц измерения
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Unit"
        500:
          description: Внутренняя ошибка сервера
  /api/units/add:
    post:
      tags: [Units]
      summary: Создание новой единицы измерения
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UnitWithoutId"
      responses:
        201:
          description: Единица измерения успешно создана
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Unit"
        400:
          description: Некорректные данные
        500:
          description: Внутренняя ошибка сервера

  /api/units/get/{id}:
    get:
      tags: [Units]
      summary: Получение информации о единице измерения
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        200:
          description: Информация о единице измерения
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Unit"
        400:
          description: Некорректный ID единицы измерения
        404:
          description: Единица измерения не найдена
        500:
          description: Внутренняя ошибка сервера
  /api/units/update/{id}:
    put:
      tags: [Units]
      summary: Обновление информации о единице измерения
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UnitWithoutId"
      responses:
        200:
          description: Единица измерения успешно обновлена
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Unit"
        400:
          description: Некорректные данные
        404:
          description: Единица измерения не найдена
        500:
          description: Внутренняя ошибка сервера
  /api/units/delete/{id}:
    delete:
      tags: [Units]
      summary: Удаление единицы измерения
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
      responses:
        200:
          description: Единица измерения успешно удалена
        400:
          description: Некорректный ID единицы измерения
        404:
          description: Единица измерения не найдена
        500:
          description: Внутренняя ошибка сервера
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    AuthRequest:
      type: object
      properties:
        username:
          type: string
        password:
          type: string
    AuthResponse:
      type: object
      properties:
        token:
          type: string
    Product:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        quantity:
          type: integer
        unit:
          type: object
          properties:
            id:
              type: integer
            name:
              type: string
            abbreviation:
              type: string
    ProductWithoutId:
      type: object
      properties:
        name:
          type: string
        quantity:
          type: integer
        unit_id:
          type: integer
    Unit:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        abbreviation:
          type: string
    UnitWithoutId:
      type: object
      properties:
        name:
          type: string
        abbreviation:
          type: string
